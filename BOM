SELECT 
  T1.STLNR AS 'FG',
  T1.STLAL AS 'BOM Usage',
  T1.STLKN AS 'BOM Header',
  T2.MATNR AS 'RM',
  CASE 
    WHEN T1.STLAL = '1' THEN T3.BMENG
    WHEN T1.STLAL = '3' THEN T4.BMENG
    ELSE NULL
  END AS 'RM Quantity'
FROM 
  STPO T1
  INNER JOIN MARA T2 ON T1.IDNRK = T2.MATNR
  LEFT JOIN STAS T3 ON T1.STLNR = T3.STLNR AND T1.STLKN = T3.STLKN AND T3.STLAL = '1'
  LEFT JOIN STAS T4 ON T1.STLNR = T4.STLNR AND T1.STLKN = T4.STLKN AND T4.STLAL = '3'
WHERE 
  T1.WERKS = 'YOUR PLANT CODE'
  AND (T1.STLAL = '1' OR T1.STLAL = '3')








SELECT
  T1.STLNR AS 'FG',
  T1.STLAL AS 'BOM Usage',
  T1.STLKN AS 'BOM Header',
  T2.MATNR AS 'RM'
FROM 
  STPO T1
  INNER JOIN MARA T2 ON T1.IDNRK = T2.MATNR
WHERE 
  T1.WERKS = 'YOUR PLANT CODE'
  AND T1.STLAL = '3'






final



SELECT
  T1.STLNR AS 'FG',
  T1.STLAL AS 'BOM Usage',
  T1.STLKN AS 'BOM Header',
  T2.MATNR AS 'RM',
  T3.BMENG AS 'RM Quantity'
FROM 
  STPO T1
  INNER JOIN MARA T2 ON T1.IDNRK = T2.MATNR
  INNER JOIN STAS T3 ON T1.STLNR = T3.STLNR AND T1.STLKN = T3.STLKN
WHERE 
  T1.WERKS = 'YOUR PLANT CODE'
